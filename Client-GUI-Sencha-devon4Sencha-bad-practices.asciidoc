:toc: macro

toc::[]



= Devon4Sencha bad practices



== Bad formed code

- *Trailing coma*

* Not every browser support it

* Difficult to debug

image::images/devon4sencha-badPractices/bad-practices/bad-practice-commaI.png[Trailing Coma 1,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/bad-practice-commaI.png"]

image::images/devon4sencha-badPractices/bad-practices/bad-practice-commaII.png[Trailing Coma 2,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/bad-practice-commaII.png"]

- Unused function parameters should be removed.

- Functions should not be too complex.

- Unused local variables should be removed.

- Control structures should use always curly brackets.

- Variables should not be redeclared.

- Each statement should end with a semicolon.

- Nested blocks of code should not be left empty.

- Sections of code should not be “commented out”.


== Excessive or unnecessary nesting of component structures



* One of the most common mistakes developers make is nesting components for no reason.



* Doing this hurts performance and can also cause oddities such as double borders or unexpected layout behavior.



* **Example**: Panel that contains a single grid. Panel is unnecessary.  The extra panel can be eliminated.  Forms, trees, tab panels and grids all extend from Panel, so you should especially watch for unnecessary nesting conditions



image::images/devon4sencha-badPractices/bad-practices/bad-panel-grid.png[Bad panel grid,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/bad-panel-grid.png"]



    Example 1A BAD: The panel is unnecessary.



image::images/devon4sencha-badPractices/bad-practices/good-panel-grid.png[Good panel grid,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/good-panel-grid.png"]    

    Example 1B Good: The grid is already a panel, so just use any panel properties directly on the grid.

   
== Memory leaks caused by failure to cleanup unused components 

* *Why my app is getting slower and slower?*

* *Failure to cleanup unused components as user navigates*

** Each time user right-clicks on a grid row a new context menu is created

** If the user keeps this app open and clicks hundreds of times, hundreds of context menus will never be destroyed

** To the developer and user, the apps “looks” visually correct because only the last context menu created is seen on the page

** Memory utilization will keep increasing 
** Slower operation / browser crash

image::images/devon4sencha-badPractices/bad-practices/unused-components.png[Unused components 1,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/unused-components.png"]

* *Better solution*

** Context menu is created once when grid is initialized and is simply reused each time

** However, if the grid is destroyed, the context menu will still exist

image::images/devon4sencha-badPractices/bad-practices/unused-components-solution.png[Unused components 2,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/unused-components-solution.png"]

* *Best solution*

** Context menu is destroyed when the grid is destroyed

image::images/devon4sencha-badPractices/bad-practices/unused-components-Best-solution.png[Unused components 3,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/unused-components-Best-solution.png"]

== Poor folder structure for source code

* Doesn’t affect performance or operation, but it makes it difficult to follow the structure of the app


    Example 1A BAD: Poor folder estructure:

image::images/devon4sencha-badPractices/bad-practices/poor-folder-stucture.png[Bad folder estructure,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/poor-folder-stucture.png"]

    Example 1B Good: Folder estructure to follow:

image::images/devon4sencha-badPractices/bad-practices/good-folder-stucture.png[Good folder estructure,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/good-folder-stucture.png"]

== Use of global variables

* Name collisions and hard to debug.

* We should hold “properties” in a class and then reference them with getters and setters.

    Instead of 

image::images/devon4sencha-badPractices/bad-practices/global-variable-III.png[Global Variable 1,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/global-variable-III.png"]

    We use 

image::images/devon4sencha-badPractices/bad-practices/global-variable-I.png[Global variable 2,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/global-variable-I.png"]

image::images/devon4sencha-badPractices/bad-practices/global-variable-II.png[Global variable 3,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/global-variable-II.png"]

image::images/devon4sencha-badPractices/bad-practices/global-variable-IV.png[Global Variable 4,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/global-variable-IV.png"]

image::images/devon4sencha-badPractices/bad-practices/global-variable-v.png[Global variable 5,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/global-variable-v.png"]

== Use of “id”

* Use of id’s on components is not recommended.

* Each id must be unique.

image::images/devon4sencha-badPractices/bad-practices/use-of-id-I.png[Use of id 1,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/use-of-id-I.png"]

* Replace by “itemId” resolves the name conflict and we can still get a reference to the component.

image::images/devon4sencha-badPractices/bad-practices/replace-by-itemId-I.png[Use of id 2,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/replace-by-itemId-I.png"]

image::images/devon4sencha-badPractices/bad-practices/replace-by-itemId-II.png[Use of id 3,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/replace-by-itemId-II.png"]

== Unreliable referencing of components

* Code that relies on component positioning in order to get a reference.

* It should be avoided as the code can easily be broken if any items are added, removed or nested within a different component.

image::images/devon4sencha-badPractices/bad-practices/unreliable-reference.png[Unreliable reference,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/unreliable-reference.png"]

image::images/devon4sencha-badPractices/bad-practices/unreliable-reference-correction.png[Unreliable reference 2,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/unreliable-reference-correction.png"]

== Failing to follow upper or lowercase naming conventions

* Avoid confusion and keep your code clean.

* Additionally, if you are firing any custom events, the name of the event should be all lowercase.

 Wrong upper lower naming convention

image::images/devon4sencha-badPractices/bad-practices/upper-lower-naming-convention.png[Naming convention 1,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/upper-lower-naming-convention.png"]

    Correct upper lower naming convention

image::images/devon4sencha-badPractices/bad-practices/upper-lower-naming-convention-correction.png[Naming convention 2,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/upper-lower-naming-convention-correction.png"]

== Making your code more complicated than necessary.

* Each value is loaded individually

image::images/devon4sencha-badPractices/bad-practices/complecated-code.png[Complicated code 1,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/complecated-code.png"]

* Use “loadRecord” method

* Review all of a component’s methods and examples to make sure you are using simple and proper techniques.

image::images/devon4sencha-badPractices/bad-practices/load-record.png[Complicated code 2,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/load-record.png"]

== Nesting callbacks are a nightmare

* Pyramidal code

* Will cost problems in the future

* Difficult to

- Read

- Comprehend

- Follow

- Debug

image::images/devon4sencha-badPractices/bad-practices/nesting-callbacks.png[Nesting callbacks 1,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/nesting-callbacks.png"]

* Use “scope”

image::images/devon4sencha-badPractices/bad-practices/nesting-callbacks-scope.png[Nesting callbacks 2,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/nesting-callbacks-scope.png"]

== Caching and references

* Wrong use of object references.

** Loop accessing an object.

** Repetition of accessing to the object.

** Use references! 

*** Store object in a variable.
*** Improvement of application performance.

* Avoid using:

- document.getElementById()

- Ext.getCmp()

- and other global queries.

* jsPerf

- JavaScript performance playground.

- Aims to provide an easy way to create and share test cases, comparing the performance of different JavaScript snippets by running benchmarks.

- http://jsperf.com

image::images/devon4sencha-badPractices/bad-practices/caching-and-references-I.png[Caching and references 1,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/caching-and-references-I.png"]

image::images/devon4sencha-badPractices/bad-practices/caching-and-references-II.png[Caching and references 2,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/caching-and-references-II.png"]

== Identation

* Code impossible to follow

- Too much!

- Inconsistent

- Waste

image::images/devon4sencha-badPractices/bad-practices/Improperly-idented-code.png[Identation 1,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/Improperly-idented-code.png"]

* Always code for readability.

image::images/devon4sencha-badPractices/bad-practices/indented-code.png[Identation 2,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/indented-code.png"]

== One class per file

* Avoid files with more than 1000 lines of code.

- Difficult to maintain

image::images/devon4sencha-badPractices/bad-practices/one-class-per-file.png[One class per file,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/one-class-per-file.png"]

- Organize your file system.

- Files and folders should match namespacing.

- Follow architectural pattern (MVC or MVVM).

- Abstraction!

- Development loader / Production builder.

== Too much work to return

* Make it easy!

image::images/devon4sencha-badPractices/bad-practices/too-much-work-I.png[Make it easy 1,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/too-much-work-I.png"]

image::images/devon4sencha-badPractices/bad-practices/too-much-work-II.png[Make it easy 2,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/too-much-work-II.png"]

image::images/devon4sencha-badPractices/bad-practices/too-much-work-III.png[Make it easy 3,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/too-much-work-III.png"]

== Comments or Documentation

* Bad practice

- No comments

- Variables with unmeaningful names

- Impossible to figure out what the is the intent of this code

image::images/devon4sencha-badPractices/bad-practices/comments-documentation-I.png[Documentation 1,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/comments-documentation-I.png"]

* Best practice

- Comment top-level structures.

- Use meaningful names : “Self-commenting” code.

- Add notes whenever logic is not obvious.

* Build your docs into a searchable tool.

- JSDuck – https://github.com/senchalabs/jsduck/wiki[https://github.com/senchalabs/jsduck/wiki]

- API documentation generator for Sencha.

image::images/devon4sencha-badPractices/bad-practices/js-duck.png[Documentation 2,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/js-duck.png"]

== “===“ “!==“ instead of “==“ “!=“

* Comparator operations

- When you receive data in a json structure and you are not sure about what you are getting you should be more restrictive.

image::images/devon4sencha-badPractices/bad-practices/comparator-operation.png[Operators,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/comparator-operation.png"]

== Be lazy

* Bad practice: Initialization of all three panels

image::images/devon4sencha-badPractices/bad-practices/be-lazy-badPractice.png[Be lazy,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/be-lazy-badPractice.png"]

* Best practice

- Lazy initialization: Add items/views only when necessary

- Lazy rendering: Save the browser some time!

- Reuse things: Save yourself some time!

image::images/devon4sencha-badPractices/bad-practices/bill-gate-says.png[Be lazy 2,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/bill-gate-says.png"]

== Knowing this!

* This

- Describes the actual object application is executing

- Defines context and scope.

* Two rules for this:

1. When a function is executed via a *var* reference, the default execution context (“this”) is *window*

2. When a function is executed via an object key, the execution context (“this”) is the object.

image::images/devon4sencha-badPractices/bad-practices/knowing-this-I.png[Knowing This,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/knowing-this-I.png"]

image::images/devon4sencha-badPractices/bad-practices/knowing-this-II.png[[Knowing This 2,width="450",link="https://github.com/devonfw/devon-guide/wiki/images/devon4sencha-badPractices/bad-practices/knowing-this-II.png"]

== Additional resources

* “Maintainable JavaScript” by Nicholas Zacha

-  http://www.slideshare.net/nzakas/maintainable-javascript-2012

* “Code Conventions for JS” by Douglass Crockford

-  http://javascript.crockford.com/code.html

* “JavaScript Performance Tips & Tricks” by Grgur Grisogono

-  http://moduscreate.com/javascript-performance-tips-tricks/