:toc: macro
toc::[]

= OASP4J Application structure 

The OASP4J archetype generates a Maven Modules Project. It has 3 Maven modules and a pom.xml file:

* xxx-core: This Maven Module Project contains the different Java classes in our application and the application configuration (beans definition, security configuration, access to database configuration, etc).

* xxx-server: This module is responsible for packaging the application as a WAR file. It has a dependency on the core module.

* pom.xml:

** Properties definition: Spring-boot version, Java version, server port, database port.

** Modules definition: Imports for 3 modules (core, EAR and server).

** Dependency Management: Spring-boot, OASP4J-BOM and JUnit dependencies. Also we can include Devonfw-BOM and Devonfw modules dependency.

** Maven plugin compiler to compile the application to desired Java version.

== Core Module

Core module contains the base classes and the base configuration for the application. Itâ€™s divided in three package: Java, Resources and Test.

image::images/oasp-app-structure/app-structure.png["App structure",width="450",link="images/oasp-app-structure/app-structure.png"]

Now, we are going to describe each of them. 

=== Java 

The package java contains all Java File that implement the application and the configuration of it.

==== SpringBootApp and SpringBootBatchApp 

*SpringBootApp* is the class that contains the main method to run the Spring Boot application. Spring Boot is responsible for scan the project and find the beans and configuration of the application. So this is the most important class in the application, because it's the application per se. You can read more about Spring Boot http://docs.spring.io/spring-boot/docs/current/reference/html/[here].

*SpringBootBatchApp* this class is responsible for run the batch process of the application. You can see more about the batch process in OASP4J project https://github.com/oasp/oasp4j/wiki/guide-batch-layer[here].

==== General 

The *general* package contains all Java files of OASP4J application. It's divided in the next sub-packages:

====== Common

Contains the reusable Java components of the OASP4J application. 

====== Dataaccess

This package contains the Java files that compose the Data Access layer of OASP4J application. You can see more about this layer https://github.com/oasp/oasp4j/wiki/guide-dataaccess-layer[here].

====== Gui.api

Contains the Java class that has the login page controller of OASP4J application.

====== Logic

Contains the logic layer of OASP4J application. The logic layer is the heart of the application and contains the main business logic. You can see more about it https://github.com/oasp/oasp4j/wiki/guide-logic-layer[here].

====== Service.impl.rest

Contains the service layer of OASP4J application. The service layer is responsible to expose functionality of the logical layer to external consumers over a network via technical protocols. You can see more about it https://github.com/oasp/oasp4j/wiki/guide-service-layer[here].
 
===== Management packages 

This package contains the Entities, DAOs, ETOs, CTOs, REST services, web services, etc., definitely a CRUD operators of the application. You can see more about how to create a CRUD operators in OASP4J project https://github.com/devonfw/devon-guide/wiki/getting-started-Crud-Operations[here].
 
=== Resources 

The resources package contain the data of some specific functionality of the application. This data, can be configuration data for, e.g, database, security or another data configuration that can be accessed by the application.

This package is divided in config, db, META-INF and static folder. Also we have an *application.propertie* file in this package. You can see more about OASP4J Spring Boot configuration https://github.com/devonfw/devon-guide/wiki/getting-started-understanding-oasp4j-spring-boot-config[here]. 

image::images/oasp-app-structure/config-structure.png["App structure 2",width="450",link="images/oasp-app-structure/config-structure.png"]

====== config

In this folder we have largely the xml configuration file of the application. This application contains also some *application.properties* files that represent the context of the application when we run it with the embedded Tomcat server. You can see more about how to run an OASP4J application https://github.com/devonfw/devon-guide/wiki/getting-started-running-sample-application[here].

The *config* folder have a folder called *app* this folder is divided in the next sub-folders:

** batch: contains the configuration of the batch process. In the Sample Application, for example, we have the bill exports and products to import.

** common: contains the Spring bean configuration of http://dozer.sourceforge.net/documentation/about.html[Dozer]. You can see more about OASP4j Bean-Mapping https://github.com/oasp/oasp4j/wiki/guide-beanmapping[here]. 

** gui: this folder contains the *dispatcher-servlet.xml*. The DispatcherServlet will take help from ViewResolver to pickup the defined view for the request.

** security: contains the *access-control-schema.xml* file that contains the definition of groups/roles and permissions of the application.

** websocket: contains the scan component package definition for websockects.

====== db

This folder contains the SQL files that contains the script templates to create the database schema and tables definition.

====== META-INF

Contains the *orm.xml* file that allow us to declare name queries that can be called in the code of the application to do an specific SQL queries.

====== static

Contains the *index.html* file of the application. This view contains ,by default, a simple logout button and a the link to a list of services of the application. 

====== application.properties

Contains the specific properties values of the application. This is taking in to account by the application when this is running in an https://github.com/devonfw/devon-guide/wiki/getting-started-running-sample-application#external-tomcat-server[external server] (not the embedded).

As you can see we have an application-<name>.properties, this kind of properties are called profile and we can active a determinate profile in *application.properties* depending on our needs. You can see more about Spring profiles http://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-profiles.html[here]. Also you can see how to create a new database profile in OASP4j https://github.com/devonfw/devon/wiki/Database-Configuration-Guide#create-a-spring-profile[here], in order to have a example to better understand.

=== Test

The package test contains all we need to test the application. It's divided in the next sub packages:

** java: contains the Unit Test of the application. Allow us to keep a control of the right functionality of the application. You can see more about the Unit Test and TDD methodology https://github.com/devonfw/devon-guide/wiki/getting-started-writing-unittest-cases[here] and https://github.com/oasp/oasp4j/wiki/guide-testing[here]

** resources: contains the configuration and data we need to run the test in of the application.

== Server Module

This module contains two important files:

* lockback.xml: This file is in the resources folder and it is the responsible to configure the log.

* pom.xml: This file has Maven configuration for packaging the application as a WAR. Also, this file has a profile to package the JavaScript client ZIP file into the WAR.

== EAR Module

In some cases we can create a EAR module to our project. This module only contains a pom.xml file to packaging the application as EAR from the WAR generated.

You can see more about how to create a new application https://github.com/devonfw/devon-guide/wiki/getting-started-creating-new-devonfw-application[here].